---
title: "Materials Needed"
author: "Factory - Pak Eddie"
date: "19 August 2021, Updated `r format(Sys.Date(), '%d %B %Y')`"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 2
    css: style.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE)

# load packages
library(tidyverse)
library(here)
library(DT)
library(readxl)
```


```{r, include=FALSE}
source("R/data-cleaning.R", local = knitr::knit_global())

# functions
source("R/foo.R", local = knitr::knit_global())
source("R/optimized_material.R", local = knitr::knit_global())
source("R/calc_steps.R", local = knitr::knit_global())

source("R/df_summary.R", local = knitr::knit_global())
```

# Total Bar Untuk Pintu

```{r}
p <- optimized_material(df_summary, type = "pintu")

p %>% 
  select(-steps) %>% 
  datatable(colnames = c("Materi", "Total Bar Perlu"))
```

## Sisa Materi Pintu {.tabset}

### `r p$materi[1]`

```{r}
calc_steps(x = df_summary, type = "pintu", material = p$materi[1], bin.step = p$steps[1]) %>% datatable()
```


### `r p$materi[2]`

```{r}
calc_steps(x = df_summary, type = "pintu", material = p$materi[2], bin.step = p$steps[2]) %>% datatable()
```


## Keperluan Ukuran Model Pintu

```{r}
df %>% 
  dplyr::filter(tipe == "pintu") %>% 
  select(-tipe3, -tipe4) %>% 
  group_by(model, tipe, tipe2, materi, ukuran, unit) %>% 
  summarise(`perlu per unit` = sum(`perlu per unit`)) %>% 
  ungroup() %>% 
  mutate("total perlu" = unit * `perlu per unit`,
         ukuran = ukuran / 10) %>% 
  rename("ukuran (cm)" = ukuran) %>% 
  datatable()
```


# Total Bar Untuk Sliding Door 

```{r}
sd <- optimized_material(df_summary, type = "sliding door")

sd %>% 
  select(-steps) %>% 
  datatable(colnames = c("Materi", "Total Bar Perlu"))
```

## Sisa Materi Sliding Door {.tabset}

### `r sd$materi[1]`

```{r}
calc_steps(x = df_summary, type = "sliding door", material = sd$materi[1], bin.step = sd$steps[1]) %>% datatable()
```

### `r sd$materi[2]`

```{r}
calc_steps(x = df_summary, type = "sliding door", material = sd$materi[2], bin.step = sd$steps[2]) %>% datatable()
```

### `r sd$materi[3]`

```{r}
calc_steps(x = df_summary, type = "sliding door", material = sd$materi[3], bin.step = sd$steps[3]) %>% datatable()
```

### `r sd$materi[4]`

```{r}
calc_steps(x = df_summary, type = "sliding door", material = sd$materi[4], bin.step = sd$steps[4]) %>% datatable()
```

### `r sd$materi[5]`

```{r}
calc_steps(x = df_summary, type = "sliding door", material = sd$materi[5], bin.step = sd$steps[5]) %>% datatable()
```

### `r sd$materi[6]`

```{r}
calc_steps(x = df_summary, type = "sliding door", material = sd$materi[6], bin.step = sd$steps[6]) %>% datatable()
```

### `r sd$materi[7]`

```{r}
calc_steps(x = df_summary, type = "sliding door", material = sd$materi[7], bin.step = sd$steps[7]) %>% datatable()
```

### `r sd$materi[8]`

```{r}
calc_steps(x = df_summary, type = "sliding door", material = sd$materi[8], bin.step = sd$steps[8]) %>% datatable()
```

### `r sd$materi[9]`

```{r}
calc_steps(x = df_summary, type = "sliding door", material = sd$materi[9], bin.step = sd$steps[9]) %>% datatable()
```


## Keperluan Ukuran Model Sliding Door

```{r}
df %>% 
  dplyr::filter(tipe == "sliding door") %>% 
  select(-tipe3, -tipe4) %>% 
  group_by(model, tipe, tipe2, materi, ukuran, unit) %>% 
  summarise(`perlu per unit` = sum(`perlu per unit`)) %>% 
  ungroup() %>% 
  mutate("total perlu" = unit * `perlu per unit`,
         ukuran = ukuran / 10) %>% 
  rename("ukuran (cm)" = ukuran) %>% 
  datatable()
```

# Total Bar Untuk Jendela 

```{r}
j <- optimized_material(df_summary, type = "jendela")

j %>%   
  select(-steps) %>% 
  datatable(colnames = c("Materi", "Total Bar Perlu"))
```

## Sisa Materi Jendela {.tabset}

### `r j$materi[1]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[1], bin.step = j$steps[1]) %>% datatable()
```

### `r j$materi[2]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[2], bin.step = j$steps[2]) %>% datatable()
```

### `r j$materi[3]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[3], bin.step = j$steps[3]) %>% datatable()
```

### `r j$materi[4]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[4], bin.step = j$steps[4]) %>% datatable()
```

### `r j$materi[5]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[5], bin.step = j$steps[5]) %>% datatable()
```

### `r j$materi[6]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[6], bin.step = j$steps[6]) %>% datatable()
```

### `r j$materi[7]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[7], bin.step = j$steps[7]) %>% datatable()
```

### `r j$materi[8]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[8], bin.step = j$steps[8]) %>% datatable()
```

### `r j$materi[9]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[9], bin.step = j$steps[9]) %>% datatable()
```

### `r j$materi[10]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[10], bin.step = j$steps[10]) %>% datatable()
```

### `r j$materi[11]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[11], bin.step = j$steps[11]) %>% datatable()
```

### `r j$materi[12]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[12], bin.step = j$steps[12]) %>% datatable()
```

### `r j$materi[13]`

```{r}
calc_steps(x = df_summary, type = "jendela", material = j$materi[13], bin.step = j$steps[13]) %>% datatable()
```

## Keperluan Ukuran Model Jendela

```{r}
df %>% 
  dplyr::filter(tipe == "jendela") %>% 
  select(-tipe3, -tipe4) %>% 
  group_by(model, tipe, tipe2, materi, ukuran, unit) %>% 
  summarise(`perlu per unit` = sum(`perlu per unit`)) %>% 
  ungroup() %>% 
  mutate("total perlu" = unit * `perlu per unit`,
         ukuran = ukuran / 10) %>%
  rename("ukuran (cm)" = ukuran) %>% 
  datatable()
```

